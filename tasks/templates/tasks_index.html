{% extends 'index.html' %}
{% load bootstrap4 %}
{% load i18n %}


{% if bootstrap_messages %}
	{% block message %}
		{% bootstrap_messages %}
	{% endblock %}
{% endif %}

{% block welcome %}
<h1>FILTER</h1>
<p>
	<form method="get" class="form">
		{% csrf_token %}
		{% bootstrap_form filter.form %}
		{% bootstrap_button "Filter" button_class="btn-success" %}

		<a href="{% url 'tasks:tasks_list' %}" class="btn btn-success">
			Clear filters
		</a>
		{% if user.is_authenticated %}
		<a href="{% url 'tasks:tasks_list' %}?creator={{request.user.pk}}" class="btn btn-success">
        	My tasks
    	</a>
		{% endif %}
	</form>
</p>
	<h1>Tasks</h1>
		<table border="2" align="center">
			<tr>
				<th>Имя</th>
				<th>Статус задачи</th>
				<th>Инициатор задачи</th>
				<th>Исполнитель задачи</th>
				<th>Метки</th>
				<th>Изменение задачи</th>
			</tr>
			{% for task in filter.qs %}
				<tr>
					<td><a href={% url 'tasks:task' task.id %}>{{ task.name }}</a></td>
					<td><a class="badge badge-danger badge-pill p-2" href={% url 'tasks:task' task.id %}>{{ task.task_status }}</a></td>
					<td><a href={% url 'tasks:task' task.id %}>{{ task.creator }}</a></td>
					<td><a href={% url 'tasks:task' task.id %}>{{ task.assigned_to }}</a></td>
					<td>
					{% for tag in task.label.all %}
						<a class="badge badge-info p-2" href={% url 'tasks:task' task.id %}>"{{ tag }}"</a>
					{% endfor %}
					</td>
					<td>
						<a class="badge badge-infop-2" href={% url 'tasks:update_task' task.id %}>Изменить</a>
						<a class="badge badge-infop-2" href={% url 'tasks:delete_task' task.id %}>Удалить</a>
					</td>

				</tr>
			{% endfor %}
		</table>

	<a class="btn btn-primary" href={% url 'tasks:create_task' %}>{% translate "Create task" %}</a>
{% endblock %}